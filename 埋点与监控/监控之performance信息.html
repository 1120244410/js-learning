<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
  </head>
  <body>
    <p>通过performance采集页面的，从加载到展示的性能相关信息</p>
  </body>
</html>
<script>
  //拿到Performance并且初始化一些参数
  const { timing, eventCounts, memory } = performance;
  let dnsTime = 0,
    tcpTime = 0,
    firstPaintTime = 0,
    domRenderTime = 0,
    loadTime = 0;
  const {
    navigationStart,
    domainLookupEnd,
    domainLookupStart,
    connectEnd,
    connectStart,
    responseStart,
    domContentLoadedEventEnd,
    loadEventEnd
  } = timing;
  dnsTime = domainLookupEnd - domainLookupStart;
  tcpTime = connectEnd - connectStart;
  firstPaintTime = responseStart - navigationStart;
  domRenderTime = domContentLoadedEventEnd - navigationStart;
  loadTime = loadEventEnd - navigationStart;
  console.log(
    "DNS解析时间:",
    dnsTime,
    "\nTCP建立时间:",
    tcpTime,
    "\n首屏时间:",
    firstPaintTime,
    "\ndom渲染完成时间:",
    domRenderTime,
    "\n页面onload时间:",
    loadTime
  );
  console.log("页面事件数量", eventCounts.length);
  const { jsHeapSizeLimit, totalJSHeapSize, usedJSHeapSize } = memory;
  console.log(
    "js内存大小限制",
    jsHeapSizeLimit,
    "\n页面js内存总大小",
    totalJSHeapSize,
    "\n已占用大小",
    usedJSHeapSize
  );
  // 时间为毫秒级
</script>
